
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <link rel="shortcut icon" href="../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.7.4">
    
    
      
        <title>Programming concepts - My Docs</title>
      
    
    
      <script src="../assets/javascripts/modernizr-1df76c4e58.js"></script>
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application-769c285a91.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
  
  
  
    <body>
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href=".." title="My Docs" class="md-icon md-icon--home md-header-nav__button">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
            
            Programming concepts
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-icon md-icon--home md-nav__button"></i>
    
    My Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../aspnetcore/" title="Aspnetcore" class="md-nav__link">
      Aspnetcore
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../links/" title="Links" class="md-nav__link">
      Links
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Programming concepts
      </label>
    
    <a href="./" title="Programming concepts" class="md-nav__link md-nav__link--active">
      Programming concepts
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dependency-injection-inversion-of-control" title="Dependency Injection / Inversion of Control" class="md-nav__link">
    Dependency Injection / Inversion of Control
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-and-why" title="What and Why?" class="md-nav__link">
    What and Why?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interfaces" title="Interfaces" class="md-nav__link">
    Interfaces
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constructor-injection" title="Constructor Injection" class="md-nav__link">
    Constructor Injection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inversion-of-control" title="Inversion of Control" class="md-nav__link">
    Inversion of Control
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ioc-containers" title="IoC Containers" class="md-nav__link">
    IoC Containers
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-problem-are-we-solving" title="What Problem are we Solving?" class="md-nav__link">
    What Problem are we Solving?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-solution" title="The Solution" class="md-nav__link">
    The Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-in-aspnet-core" title="Implementation in ASP.Net Core" class="md-nav__link">
    Implementation in ASP.Net Core
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dependency-injection-inversion-of-control" title="Dependency Injection / Inversion of Control" class="md-nav__link">
    Dependency Injection / Inversion of Control
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-and-why" title="What and Why?" class="md-nav__link">
    What and Why?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interfaces" title="Interfaces" class="md-nav__link">
    Interfaces
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constructor-injection" title="Constructor Injection" class="md-nav__link">
    Constructor Injection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inversion-of-control" title="Inversion of Control" class="md-nav__link">
    Inversion of Control
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ioc-containers" title="IoC Containers" class="md-nav__link">
    IoC Containers
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-problem-are-we-solving" title="What Problem are we Solving?" class="md-nav__link">
    What Problem are we Solving?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-solution" title="The Solution" class="md-nav__link">
    The Solution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-in-aspnet-core" title="Implementation in ASP.Net Core" class="md-nav__link">
    Implementation in ASP.Net Core
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="programming-concepts">Programming Concepts<a class="headerlink" href="#programming-concepts" title="Permanent link">&para;</a></h1>
<hr />
<h2 id="dependency-injection-inversion-of-control">Dependency Injection / Inversion of Control<a class="headerlink" href="#dependency-injection-inversion-of-control" title="Permanent link">&para;</a></h2>
<p><a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection">Introduction to Dependency Injection in ASP.NET Core</a> - Microsoft page</p>
<h3 id="what-and-why">What and Why?<a class="headerlink" href="#what-and-why" title="Permanent link">&para;</a></h3>
<blockquote>
<p>A <strong>dependency</strong> is another class that the code you are writing depends on.</p>
</blockquote>
<p>Say you are writing an app and you want to log certain performance information - maybe you get current weather data from a web service and you want to log how long each request takes. You write a class to do that logging and call it <code class="codehilite">Logger</code> with a <code class="codehilite">Log(string message)</code> method which writes your message to a file.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">Logger</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Log</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// write message to log file</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Here is the class which gets the weather data and logs the time taken. </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">WeatherForecast</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Logger</span><span class="p">();</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">GetWeather</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Stopwatch</span> <span class="n">sw</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Stopwatch</span><span class="p">();</span>
        <span class="n">sw</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
        <span class="c1">// Get weather info from web service ...</span>
        <span class="n">sw</span><span class="p">.</span><span class="n">Stop</span><span class="p">();</span>
        <span class="n">logger</span><span class="p">.</span><span class="n">Log</span><span class="p">(</span><span class="err">$</span><span class="s">&quot;Webservice time = {sw.Elapsed}&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Your <code class="codehilite">WeatherForecast</code> object now <strong>depends</strong> on the <code class="codehilite">Logger</code> class. The <code class="codehilite">Logger</code> class is hard-coded into your program. We say that there is 'tight coupling' between the <code class="codehilite">WeatherForecast</code> and the <code class="codehilite">Logger</code> classes.</p>
<p>Now this is all well and good for a small app that is not going to change, but has several drawbacks.</p>
<ol>
<li>It is not easy to test <code class="codehilite">WeatherForecast</code> without having to open up the log file to see what was actually written to it.</li>
<li>It is not easy to change the logger if we decide that instead of logging to a file we want to log to a database instead.</li>
</ol>
<p>It would be nice if we could just write <code class="codehilite">WeatherForecast</code> so that it could use any logger object that we decided to give it. The we could use a test logger for testing, another for logging to file, and another for writing the messages to a database, and so on. It would be really nice if, when we wrote <code class="codehilite">WeatherForecast</code>, we didn't need to know anything about the logger that would ultimately be used other than all we had to do was pass it a message.</p>
<p>The problem, of course, is the line</p>
<p><code class="codehilite">private Logger logger = new Logger();</code></p>
<p>To write this line of code we hard code a reference to the <code class="codehilite">Logger</code> class, and once we have written it we can't change the logger without changing the <code class="codehilite">WeatherForecast</code> source code. Instead of hard-coding the dependancy, we would like to be able to pass the dependency in to <code class="codehilite">WeatherForecast</code> when we run our code.</p>
<h3 id="interfaces">Interfaces<a class="headerlink" href="#interfaces" title="Permanent link">&para;</a></h3>
<blockquote>
<p>An <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/interface">Interface</a> defines the signatures of methods, properties, events or indexers of a class. A class or struct that implements the interface must implement the members of the interface that are specified in the interface definition.</p>
</blockquote>
<p>An interface defines what a class will look like 'from the outside'. If a class implements a particular interface, you know that it will have the exact methods and properties etc. that are defined in the interface, with those exact parameters and types and return values. What goes on inside the class is none or your concern - what is important is that you know the interface and so you can use it in your program.</p>
<p>Several different implementations of the interface might perform the task in completely different ways. For example, we could have one implementations of a logger interface which logs to file and another which logs to a database, but because they look exactly the same from the outside they can be used interchangeably in your program.</p>
<p>First we need to define an interface that describes the essential public methods of our logger.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">public</span> <span class="k">interface</span> <span class="n">ILogger</span>
<span class="p">{</span>
    <span class="k">void</span> <span class="nf">Log</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>This interface dictates that anything that impements it must provide a <code class="codehilite">Log</code> method which takes a string as a parameter and returns a void.</p>
<p>Now we can write a logger class which implements this interface.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">FileLogger</span> <span class="p">:</span> <span class="n">ILogger</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Log</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// code to write message to file</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h3 id="constructor-injection">Constructor Injection<a class="headerlink" href="#constructor-injection" title="Permanent link">&para;</a></h3>
<p>One simple form of dependency injection is 'Constructor Injection'. We pass the dependency that we want the class to use into to class through its constructor at the time we instantiate an instance of the class.</p>
<p>Here is a modified version of our class which takes a logger object in its constructor, keeps a reference to it in a private variable, and uses that logger when it needs to log something.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">WeatherForecast</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="n">ILogger</span> <span class="n">logger</span><span class="p">;</span>

    <span class="k">public</span> <span class="nf">WeatherForecast</span><span class="p">(</span><span class="n">ILogger</span> <span class="n">specific_Logger_to_Use</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">logger</span> <span class="p">=</span> <span class="n">specific_Logger_to_Use</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">GetWeather</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Stopwatch</span> <span class="n">sw</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Stopwatch</span><span class="p">();</span>
        <span class="n">sw</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
        <span class="c1">// Get weather info from web service ...</span>
        <span class="n">Thread</span><span class="p">.</span><span class="n">Sleep</span><span class="p">(</span><span class="m">1000</span><span class="p">);</span>
        <span class="n">sw</span><span class="p">.</span><span class="n">Stop</span><span class="p">();</span>
        <span class="n">logger</span><span class="p">.</span><span class="n">Log</span><span class="p">(</span><span class="err">$</span><span class="s">&quot;Webservice time = {sw.Elapsed}&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Note in line 3 that our private variable is of type <code class="codehilite">ILogger</code>. We don't need to know which specific type of logger we are eventually going to get, just so long as it implements <code class="codehilite">ILogger</code>.</p>
<p>When we instantiate our class we can pass it a file logger, an email logger, or any other logger that implements the <code class="codehilite">ILogger</code> interface. We can even make a mock logger that we can use during testing.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Program</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// this time we are going to use a FileLogger</span>
        <span class="n">FileLogger</span> <span class="n">fileLogger</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FileLogger</span><span class="p">();</span>

        <span class="c1">// create a new instance of WeatherForecast and pass it the FileLogger to use</span>
        <span class="n">WeatherForecast</span> <span class="n">forecast</span> <span class="p">=</span> <span class="k">new</span> <span class="n">WeatherForecast</span><span class="p">(</span><span class="n">fileLogger</span><span class="p">);</span>

        <span class="n">forecast</span><span class="p">.</span><span class="n">GetWeather</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Now <code class="codehilite">WeatherForecast</code> does not have to know which specific logger it is going to use - it only cares that when we come to use it we pass it a logger object that implements the <code class="codehilite">ILogger</code> interface. In this program we are giving it a <code class="codehilite">FileLogger</code>, but in another program we might give it a <code class="codehilite">DatabaseLogger</code> and we wouldn't have to change <code class="codehilite">WeatherForecast</code> at all.</p>
<p>This is good because we can write <code class="codehilite">WeatherForecast</code>, test it, and tuck it away in a library somewhere and never have to touch it again. We can use it in lots of places, and each time we use it we can decide at the time which logger we want <code class="codehilite">WeatherForecast</code> to use.</p>
<p>We have 'injected' the dependency into <code class="codehilite">WeatherForecast</code> at the time we instantiated it.</p>
<h3 id="inversion-of-control">Inversion of Control<a class="headerlink" href="#inversion-of-control" title="Permanent link">&para;</a></h3>
<p>IoC (<a href="https://martinfowler.com/bliki/InversionOfControl.html">Inversion of Control</a>) is a general programming principle where the flow of control through the program (which would normally have been under 'your' control) is 'inverted' so it is now under the control of a framework.</p>
<p>For example, in traditional text based programming (such as a batch file or a console program) you might write something to get the users name and greet them.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="s">&quot;Enter your name: &quot;</span><span class="p">);</span>
    <span class="kt">string</span> <span class="n">name</span> <span class="p">=</span> <span class="n">Console</span><span class="p">.</span><span class="n">ReadLine</span><span class="p">();</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="err">$</span><span class="s">&quot;Welcome, {name}&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>The flow of the program is enitely under your control. You decide when to output to the console, and you decide when to read input from the console. It is your code that is running, and you make calls into other code (such as <code class="codehilite">Console.WriteLine</code>) when you need to.</p>
<p>However, if you are using some kind of framework (Windows forms, ASP.NET, Android, etc.) you might have a form with a text entry box labelled 'Enter your name', a button labelled 'Next', and an empty label called response. Your code would look something like</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">private</span> <span class="k">void</span> <span class="nf">NextButton_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Response</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="err">$</span><span class="s">&quot;Welcome, {NameEntry.Text}&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Now it is <em>not</em> your code that is in control - the <em>framework</em> is in control. When the user runs the application, it is the framework code that is running, and when the user hits the 'Next' button the framework makes a call into your code through the event handler mechanism.</p>
<p>You have handed control off to the framework and told it, "Call me when you need me to do something." This is also known as the <a href="http://deviq.com/hollywood-principle/">Hollywood Principle</a> - "Don't call us. We'll call you!"</p>
<p>There are many forms that this inversion of control can take, but an important factor in all of them is that the framework code is already written and you don't want to be messing with it. Somehow you need to be able to get the framework to call your code when the framework designer, at the time the framework was written, had no idea that your code even existed (in fact, it probably didn't).</p>
<p>Registering for events is one programming pattern which can achieve this. In the code above we have (elsewhere) told the framework which method to call when the button gets pushed. (Often this hookup is done behind the scenes by the graphical designer you use to create your form). When the button is pushed, the framework calls the <code class="codehilite">NextButton_Click</code> method to execute <em>our</em> code. The only stipulation is that the <code class="codehilite">NextButton_Click</code> method conforms to what the framework expects by way of parameters and return type for an event handler.</p>
<p>Dependency Injection is just another method of Inversion of Control, where your code (say, the logger) gets called by some other code (maybe the framework, maybe some other bit of your code) that itself knows nothing about your logger. All you need to do is follow the rules (ie. implement the <code class="codehilite">ILogger</code> interface) and you can get the other code to call your code whenever it needs to.</p>
<h2 id="ioc-containers">IoC Containers<a class="headerlink" href="#ioc-containers" title="Permanent link">&para;</a></h2>
<p>We could just stop there, because with Dependency Injection we have all we need to 'decouple' (ie. make independent) parts of our code. We can write a <code class="codehilite">GetWeather</code> class which uses a logger, and we don't care which logger is used when we write the <code class="codehilite">GetWeather</code> class (as long as it implements <code class="codehilite">ILogger</code>). And we can write lots of other classes that use loggers, and write lots of different loggers, and mix and match to our heart's content. And many applications do just use manual Dependency Injection like this, where in the final application the desired logger service is supplied to each particular consumer class.</p>
<p>However, we can go another step in automating this process by using what is called an IoC Container.</p>
<p>The code behind an IoC Container (sometimes also called a DI Container) can get a little complex and we are not going to delve into it at all in this article. There are <a href="https://www.hanselman.com/blog/ListOfNETDependencyInjectionContainersIOC.aspx">many ready-made IoC Containers</a> available, and ASP.NET Core includes a simple one as part of the framework which is used so that <em>you</em> can tell the <em>framework</em> what you want it to use as (for example) a logger. You can pick one of the many existing classes or make your own. You can also use the IoC Container to handle dependency injection for your own code.</p>
<h3 id="what-problem-are-we-solving">What Problem are we Solving?<a class="headerlink" href="#what-problem-are-we-solving" title="Permanent link">&para;</a></h3>
<p>Earlier we used this code to instatiate a logger of our choice and pass it to <code class="codehilite">WeatherForecast</code></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">// this time we are going to use a FileLogger</span>
<span class="n">FileLogger</span> <span class="n">fileLogger</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FileLogger</span><span class="p">();</span>

<span class="c1">// create a new instance of WeatherForecast and pass it the FileLogger to use</span>
<span class="n">WeatherForecast</span> <span class="n">forecast</span> <span class="p">=</span> <span class="k">new</span> <span class="n">WeatherForecast</span><span class="p">(</span><span class="n">fileLogger</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p>There are two possible problems with this.</p>
<ol>
<li>We might use this bit of code (or a bit very similar) in many places. If we wanted to change loggers to use the database logger instead we would have a lot of places to go and change our code.</li>
<li>The above example is very simple because although the <code class="codehilite">WeatherForecast</code> class has a dependency on a logger, the logger does not have a dependency on anything else. This is often not the case. Maybe our database logger needs a database object in it's constructor (and there may be several different types of database we could pass it), and each database object needs a connection string passed into it's constructor. Quite soon we end up with a complex 'dependency graph' - a large tree of objects depending on objects depending on objects.</li>
</ol>
<p>In the code above, the line</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">WeatherForecast</span> <span class="n">forecast</span> <span class="p">=</span> <span class="k">new</span> <span class="n">WeatherForecast</span><span class="p">(</span><span class="n">fileLogger</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p>is where we instantiate our <code class="codehilite">WeatherForecast</code> object. The logger we are using is hard coded into this line which is inflexible and hard to maintain, especially where either of the above two points apply.</p>
<h3 id="the-solution">The Solution<a class="headerlink" href="#the-solution" title="Permanent link">&para;</a></h3>
<p>An IoC Container is a 'factory' which instantiates instances of classes for us, and in doing so also instantiates instances of all the dependencies that those classes need and injects them through the constructors. There are various different ways that such containers can be implemented, but the following is typical.</p>
<p>First we create an instance of a container, and then we 'register' all the dependencies with it.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">IOContainer</span> <span class="n">iocContainer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">IOCContainer</span><span class="p">();</span>

<span class="n">iocContainer</span><span class="p">.</span><span class="n">AddService</span><span class="p">&lt;</span><span class="n">ILogger</span><span class="p">,</span> <span class="n">FileLogger</span><span class="p">&gt;();</span>
</pre></div>
</td></tr></table>

<p>This code registers the concrete type <code class="codehilite">FileLogger</code> and tell the container to use a <code class="codehilite">FileLogger</code> wherever it needs a concrete implementation of <code class="codehilite">ILogger</code>.</p>
<p>Then we can use the container to create an instance of our <code class="codehilite">WeatherForecast</code> class as follows.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">WeatherForcast</span> <span class="n">forecast</span> <span class="p">=</span> <span class="n">iocContainer</span><span class="p">.</span><span class="n">Resolve</span><span class="p">&lt;</span><span class="n">WeatherForecast</span><span class="p">&gt;();</span>
</pre></div>
</td></tr></table>

<p>The container looks at the <code class="codehilite">WeatherForecast</code> class we have asked for and sees that in its constructor it needs an instance of an <code class="codehilite">ILogger</code>. It looks at what has been registered and sees that for an <code class="codehilite">ILogger</code> it needs to create an instance of the <code class="codehilite">FileLogger</code> class, which it does. It can now create an instance of the <code class="codehilite">WeatherForecast</code> class, passing the <code class="codehilite">FileLogger</code> to its constructor.</p>
<p>When we want to change the logger, we only have to change it in the one place where we regisered it with the container, which is normally done right at the beginning of the program before anything else.</p>
<p>Also, if there is a deep tree of nested dependencies (which is quite normal in many programs) the container will create instances of all the dependencies that are needed - all we need to do is register them.</p>
<h2 id="implementation-in-aspnet-core">Implementation in ASP.Net Core<a class="headerlink" href="#implementation-in-aspnet-core" title="Permanent link">&para;</a></h2>
<hr />
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../links/" title="Links" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Links
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application-c35428f87f.js"></script>
      
      
      <script>app.initialize({url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>